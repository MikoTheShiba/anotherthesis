var mimsdb = {
    "0": {
        "ill":"Cholesterol",
        "gen":"Astorvastatin FC",
        "brd":"Astorvastatin FC",
        "dos":"20mg",
        "SRP":9
    },
    "1": {
        "ill":"Cholesterol",
        "gen":"Astorvastatin FC",
        "brd":"Ator-10",
        "dos":"10mg",
        "SRP":12.75
    },
    "2": {
        "ill":"Cholesterol",
        "gen":"Astorvastatin FC",
        "brd":"Lipitor",
        "dos":"10mg",
        "SRP":34.25
    },
    "3": {
        "ill":"Cholesterol",
        "gen":"Astorvastatin FC",
        "brd":"RiteMed Atorvastatin",
        "dos":"10mg",
        "SRP":12
    },
    "4": {
        "ill":"Cholesterol",
        "gen":"Astorvastatin FC",
        "brd":"Atonamis",
        "dos":"20mg",
        "SRP":4.5
    },
    "5": {
        "ill":"Cholesterol",
        "gen":"Astorvastatin FC",
        "brd":"Brelvastin", 
        "dos":"20mg",
        "SRP":5.5
    },
    "6": {
        "ill":"Cholesterol",
        "gen":"Astorvastatin FC",
        "brd":"Astorvastatin FC",
        "dos":"40mg",
        "SRP":9.5
    },
    "7": {
        "ill":"Cholesterol",
        "gen":"Astorvastatin FC",
        "brd":"Atorwin",
        "dos":"40mg",
        "SRP":47.75
    },
    "8": {
        "ill":"Cholesterol",
        "gen":"Astorvastatin FC",
        "brd":"Ator-40",
        "dos":"40mg",
        "SRP":26
    },
    "9": {
        "ill":"Cholesterol",
        "gen":"Astorvastatin FC",
        "brd":"Atorvast-Natrapharm",
        "dos":"40mg",
        "SRP":22
    },
    "10": {
        "ill":"Cholesterol",
        "gen":"Astorvastatin FC",
        "brd":"Brelvastin",
        "dos":"40mg",
        "SRP":9.5
    },
    "11": {
        "ill":"Cholesterol",
        "gen":"Rosuvastatin FC",
        "brd":"Rosuvastatin FC",
        "dos":"10mg",
        "SRP":9
    },
    "12": {
        "ill":"Cholesterol",
        "gen":"Rosuvastatin FC",
        "brd":"Rovista",
        "dos":"5mg",
        "SRP":23.25
    },
    "13": {
        "ill":"Cholesterol",
        "gen":"Rosuvastatin FC",
        "brd":"Rovista",
        "dos":"10mg",
        "SRP":28.75
    },
    "14": {
        "ill":"Cholesterol",
        "gen":"Rosuvastatin FC",
        "brd":"Rosutin",
        "dos":"10mg",
        "SRP":12.75
    },
    "15": {
        "ill":"Cholesterol",
        "gen":"Rosuvastatin FC",
        "brd":"Rosuvastatin FC",
        "dos":"20mg",
        "SRP":15.5
    },
    "16": {
        "ill":"Cholesterol",
        "gen":"Rosuvastatin FC",
        "brd":"Rovista",
        "dos":"20mg",
        "SRP":33
    },
    "17": {
        "ill":"Cholesterol",
        "gen":"Rosuvastatin FC",
        "brd":"Vestflo-20",
        "dos":"20mg",
        "SRP":17.75
    },
    "18": {
        "ill":"Anti-Hypertension",
        "gen":"Losartan",
        "brd":"Losartan",
        "dos":"50mg",
        "SRP":2.75
    },
    "19": {
        "ill":"Anti-Hypertension",
        "gen":"Losartan",
        "brd":"Amlife",
        "dos":"50mg",
        "SRP":23.5
    },
    "20": {
        "ill":"Anti-Hypertension",
        "gen":"Losartan",
        "brd":"Neosartan",
        "dos":"50mg",
        "SRP":13.5
    },
    "21": {
        "ill":"Anti-Hypertension",
        "gen":"Losartan",
        "brd":"Lifezar",
        "dos":"50mg",
        "SRP":26.5
    },
    "22": {
        "ill":"Anti-Hypertension",
        "gen":"Losartan",
        "brd":"Losaar-50",
        "dos":"50mg",
        "SRP":4
    },
    "23": {
        "ill":"Anti-Hypertension",
        "gen":"Losartan",
        "brd":"Angisartan",
        "dos":"50mg",
        "SRP":4
    },
    "24": {
        "ill":"Anti-Hypertension",
        "gen":"Amlodipine Bestilate",
        "brd":"Amlodipine Bestilate",
        "dos":"5mg",
        "SRP":1
    },
    "25": {
        "ill":"Anti-Hypertension",
        "gen":"Amlodipine Bestilate",
        "brd":"Eodipine",
        "dos":"5mg",
        "SRP":2.5
    },
    "26": {
        "ill":"Anti-Hypertension",
        "gen":"Amlodipine Bestilate",
        "brd":"Lodi",
        "dos":"5mg",
        "SRP":8.25
    },
    "27": {
        "ill":"Anti-Hypertension",
        "gen":"Amlodipine Bestilate",
        "brd":"RiteMed Amlodipine",
        "dos":"5mg",
        "SRP":6.75
    },
    "28": {
        "ill":"Anti-Hypertension",
        "gen":"Amlodipine Bestilate",
        "brd":"Amyasc BE",
        "dos":"5mg",
        "SRP":19.75
    },
    "29": {
        "ill":"Anti-Hypertension",
        "gen":"Amlodipine Bestilate",
        "brd":"Vasalat",
        "dos":"5mg",
        "SRP":13.5
    },
    "30": {
        "ill":"Anti-Hypertension",
        "gen":"Amlodipine Bestilate",
        "brd":"Amlodipine",
        "dos":"5mg",
        "SRP":2.5
    },
    "31": {
        "ill":"Anti-Hypertension",
        "gen":"Carvedilol FC (Betadol)",
        "brd":"Carvedilol FC (Betadol)",
        "dos":"6.5mg",
        "SRP":4.5
    },
    "32": {
        "ill":"Anti-Hypertension",
        "gen":"Carvedilol FC (Betadol)",
        "brd":"Karyil",
        "dos":"6.5mg",
        "SRP":9.75
    },
    "33": {
        "ill":"Anti-Hypertension",
        "gen":"Carvedilol FC (Betadol)",
        "brd":"Caryid",
        "dos":"6.5mg",
        "SRP":12
    },
    "34": {
        "ill":"Anti-Hypertension",
        "gen":"Carvedilol FC (Betadol)",
        "brd":"Karyidol",
        "dos":"25mg",
        "SRP":8.25
    },
    "35": {
        "ill":"Anti-Hypertension",
        "gen":"Carvedilol FC (Betadol)",
        "brd":"Carvedilol",
        "dos":"6.25mg",
        "SRP":6
    },
    "36": {
        "ill":"Anti-Hypertension",
        "gen":"Carvedilol FC (Betadol)",
        "brd":"Velon",
        "dos":"6.25mg",
        "SRP":5
    },
    "37": {
        "ill":"Anti-Hypertension",
        "gen":"Clopidoger",
        "brd":"Clopidoger",
        "dos":"75mg",
        "SRP":8
    }
}

const altgetter = (genlist) => {
    let alts = [];
    genlist.map((x) => {let fdb = Object.entries(mimsdb).filter(([key,obj]) => obj.gen === x); let fin=alts.concat(fdb); alts=fin;})
    console.log(alts)
    return alts.map(([key, obj]) => key);
  }
  const altgetter2 = (genlist) => {
      let alts = []
      console.log(genlist)
      genlist[0].map((x) => {
          let filterA = Object.entries(mimsdb).filter(([key,obj]) => obj.gen === x && genlist[1][genlist[0].indexOf(x)].includes(obj.dos));
          let fin=alts.concat(filterA);
          alts=fin;
      })
      console.log(alts)
      return alts.map(([key, obj]) => key);
  }
  const dctable = (medlist) => {
    let td = medlist.map(tablegenerator);
    let finalstring = ``;
    td.map((x) => finalstring=finalstring+x);
    return finalstring;
  }
  const datable = (medlist) => {
    let genlist = []
    let finalstring = ``;
    medlist.map((x) => {let n = mimsdb[String(x)]['gen']; if(genlist.indexOf(n) == -1){genlist.push(n)}});
    altgetter(genlist).map((x) => finalstring=finalstring+tablegenerator(x))
    return finalstring;
  }
  const datable2 = (medlist) => {
      let genlist = [[],[]];
      let finalstring = ``;
      medlist.map((x) => {
          let n = mimsdb[String(x)]['gen'];
          let m = mimsdb[String(x)]['dos'];
          if(genlist[0].indexOf(n) == -1){
              genlist[0].push(n);
              genlist[1].push([m]);
          } else {
                if(genlist[1][genlist[0].indexOf(n)].indexOf(m) == -1){
                  genlist[1][genlist[0].indexOf(n)].push(m);
              }
          }
          
      })
      altgetter2(genlist).map((x) => finalstring=finalstring+tablegenerator(x))
      return finalstring;
  }
  const tablegenerator = (id) => {
    let xd = String(id);
    return `gen: ${mimsdb[xd]['gen']} 
    dos: ${mimsdb[xd]['dos']} \n`
    /*return `
      <tr style="border: 1px solid black">
        <td style="border: 1px solid black">${mimsdb[xd]['brd']}</td>
        <td style="border: 1px solid black">${mimsdb[xd]['ill']}</td>
        <td style="border: 1px solid black">${mimsdb[xd]['gen']}</td>
        <td style="border: 1px solid black">${mimsdb[xd]['dos']}</td>
        <td style="border: 1px solid black">${String(mimsdb[xd]['SRP'])}</td>
      </tr>
    `*/
  }
  var selmed = [10, 11, 12,18,19];
  //console.log(datable(selmed))
  console.log(datable2(selmed))
  
  /*note to self:
  Step 1: Create a double nested array
  */